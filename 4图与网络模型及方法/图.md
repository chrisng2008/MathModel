[toc]

# 图与网络模型及方法

## 图的概念

图的概念在学习数据结构还有离散数学的时候学习过，简单了解即可，这里不解释。

## 最短路问题

求解最短路问题已有成熟的算法，如狄克斯特拉(Dijkstra)算法，具体实现B站或者油管有很多讲解的视频。

### 两指定顶点之间的最短路径

#### 例4.1

邻接矩阵为
$$
a = \left[
\begin{matrix}
  0  & 50 & \infin & 40 & 25 & 10\\
  50 & 0 & 15 & 20 & \infin & 25\\
  \infin  & 15 & 0 & 10 & 20 & \infin \\
  40  & 20 & 10 & 0 & 10 & 25\\
  25  & \infin & 20 & 10 & 0 & 55\\
  10  & 25 & \infin & 25 & 55 & 0\\
\end{matrix}
\right]
$$


```matlab
clear;
clc;
%% 构建临界矩阵
% 由于临界矩阵是对称矩阵，所以我们只需要构建对角线一侧的即可，构建完后将本身与其的转置矩阵相加即可得到邻接矩阵
a = zeros(6);%邻接矩阵初始化
a(1,2)=50;a(1,4)=40;a(1,5)=25;a(1,6)=10;
a(2,3)=15;a(2,4)=20;a(2,6)=25;
a(3,4)=10;a(3,5)=20;
a(4,5)=10;a(4,6)=25;
a(5,6)=55;
a = a+a';
a(a==0)=inf; % 将对角线处的元素赋值为inf
%%

%% 变量初始化
pb(1:length(a))=0;pb(1)=1;index1=1;index2=ones(1,length(a));
d(1:length(a))=inf;d(1)=0;
% length(a)返回的是a的列数
% 行向量pb用来存放P标号信息
% index1用来存放标点顺序
% index2用来存放标点顶点索引
% index2(i)用来存放初始点到最短通路中第i顶点前一顶点的序号
% d用来存放最短通路的值
% d(i)用来存放初始点到第i顶点最短通路的值
%%

temp = 1;% 最新P标号的点
while sum(pb) < length(a)
    tb = find(pb == 0);% 寻找还没有走过的点
    d(tb) = min(d(tb),d(temp)+a(temp,tb));%比较直达路线和当前顶点到最新顶点到终点哪一个路径更短
    tmpb = find(d(tb)==min(d(tb)));
    temp = tb(tmpb(1)); % 可能有多个点同时达到最小值，只取其中的一个
    pb(temp)=1;% 标记最新的点
    index1 = [index1,temp];%记录移动顺序
    temp2 = find(d(index1)==d(temp)-a(temp,index1));%记录前一个顶点的位置
    index2(temp)=index1(temp2(1));
end
% d =
%
%     0    35    45    35    25    10
% 得到c1到c2,c3,c4,c5,c6的最低票价为35,45,35,25,10
% index1 =
%
%     1     6     5     2     4     3
```

#### 通用Dijkstra代码

```matlab
function [mydistance,mypath] = mydijkstra(a,sb,db);
% 输入：a——邻接矩阵；a(i,j)——i到j之间的距离，可以是有向的
% sb——起点的标号，db——终点的标号
% 输出：mydistance——最短路的距离，mypath——最短路的距离
n = size(a,1);visited(1:n) = 0;
distance(1:n) = inf;distance(sb) = 0;%起点到各顶点距离的初始化
visited(sb)=1;u=sb;%u为最新的P标点顶点
parent(1:n) = 0;% 前驱顶点的初始化
for i = 1:n-1
    id = find(visited == 0);% 查找未标号的顶点
    for v = id
        if a(u.v)+distance(u) < distance(v)
            distance(v) = distance(u)+a(u.v); %修改标号值
            parent(v) = u;
        end
    end
    temp=distance;
    temp(visited==1)=inf;% 以标号的距离换成无穷
    [t，u]=min(temp); % 找标号值最小的顶点
    visited(u)=1;% 标记已经标号的顶点
end
mypath=[];
if parent(db) ~= 0 % 如果存在路！
    t = db; mypath = [db];
    while t ~= sb
        P = parent(t);
        mypath = [P mypath];
        t = p;
    end
end
mydistance = distance(db);
```

### 两个指定顶点之间最短路径问题的数学规划模型

设$W=(\omega_{ij})_{n \times n}$为邻接矩阵，其分量为
$$
\omega_{ij}=
\begin{cases}
弧v_i v_j的权值，&v_i v_j \in E,\\
\infin,&其他
\end{cases}
$$
决策变量为$x_{ij}$,当$x_{ij}=1$，说明弧$v_i v_j$位于顶点$v_1$至顶点$v_n$的最短路上；否则$x_{ij}=0$。其数学规划的表达式为

$$
\min \sum_{v_i v_j\in E}\omega_{ij}x_{ij},\\
s.t.
\begin{cases}
\sum_{j=1\\v_iv_j\in E}^{n}x_ix_j-\sum_{j=1\\v_jv_i\in E}^{n}x_jx_i = 
\begin{cases}
1,& i=1,\\
-1, & i=n,\\
0, & i \neq 1,n,
\end{cases}
\\
x_{ij}=0或1.
\end{cases}
$$



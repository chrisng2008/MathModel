[toc]

# 插值与拟合

## 插值和拟合的区别

<img src="https://pic3.zhimg.com/v2-2d00103d6c2813e686caba5917d184c6_r.jpg?source=1940ef5c" alt="preview" style="zoom: 80%;" />

图片取自知乎用户yang元祐的回答

**插值**：函数一定经过原始数据点。

假设f(x)在某区间[a,b]上一系列点上的值
$$
y_i=f(x_i),i=0,1,\dots,n。
$$
插值就是用较简单、满足一定条件的函数$\varphi(x)$去代替$f(x)$。插值函数满足条件
$$
\varphi(x_i)=y_i,i=0,1,\dots,n
$$


**拟合**：用一个函数去近似原函数，不要求过已知数据点，只要求在某种意义下它在这些点上的总偏差最小。

## 插值方法

### 分段线段插值

分线段插值就是将每两个相邻的节点用直线连起来，如此形成的一条折线就是就是分段线性插值函数，记作$I_n(x)$,它满足$I_n(x_i)=y_i$,且$I_n(x)$在每个小区间$[x_i,x_{i+1}]$上是线性函数$(i=0,1\dots,n-1)$。

$I_n(x)$可以表示为$I_n(x)=\sum_{i=0}^n y_il_i(x)$，其中
$$
l_i(x)=
\begin{cases}
\frac{x-x_{i-1}}{x_i-x_{i-1}},&x\in [x_{i-1},x_i],i \neq 0,\\
\frac{x-x_{i+1}}{x_i-x_{i+1}},&x\in [x_i,x_{i+1}],i \neq n,\\
0,&其他
\end{cases}
$$


$I_n(x)$有良好的收敛性，即对$x\in [a,b]$,有
$$
\lim _{n \rightarrow \infin}I_n(x)=f(x)
$$
用$I_n(x)$计算x点的插值的时候，只用到x左右的两个点，计算量与节点个数n无关。但是n越大，分段越多，插值误差越小。

### 拉格朗日插值多项式

朗格朗日(Lagrange)插值的基函数为
$$
\begin{aligned}
l_i(x)&=\frac{(x-x_0)\cdots(x-x_{i-1})(x-x_{i+1})\cdots(x-x_n)}{(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_{i+1})\cdots(x_i-x_n)}\\
&= \prod_{j=0\\j\neq i}^{n} \frac{x-x_j}{x_i -x_j},i=0,1,\cdots,n。
\end{aligned}
$$

$l_i(x)$是xn次多项式，满足
$$
l_i(x_j)=
\begin{cases}
0,&j\neq i,\\
1,& j = i。
\end{cases}
$$
拉格朗日插值函数函数
$$
L_n(x)=\sum_{i=0}^{n}y_i l_i(x)=\sum_{i=0}^{n} y_i(\prod_{j=0\\j\neq i}^n \frac{x-x_j}{x_i -x_j})
$$




### 样条插值





### Matlab插值工具箱





## 曲线拟合的线性最小二乘法

### 最小二乘法的Matlab实现





## 最小二乘优化

### lsqlin函数



### lsqcurvefit函数



### lsqnonlin函数



### lsqnonneg函数

### Matlab的曲线拟合用户图形界面解法





## 曲线拟合与函数逼近







